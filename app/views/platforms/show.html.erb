<%= form_tag(products_path, method: :get, id: "filter-form") do %>
  <%= check_box_tag :on_sale, true, params[:on_sale] == "true", onchange: "this.form.submit();" %>
  <%= label_tag :on_sale, "Show on-sale products only" %>
  <br>
  <%= check_box_tag :added_this_week, true, params[:added_this_week] == "true", onchange: "this.form.submit();" %>
  <%= label_tag :added_this_week, "Show products added this week only" %>
<% end %>

<div id="product-grid">
  <% @products.each do |product| %>
    <aside>
      <div>
        <% if product.image.present? %>
          <%= image_tag product.image.variant(resize_to_limit: [250, 250]).processed %>
        <% else %>
          <%= image_tag 'placeholder.jpg', size: '250x250' %>
        <% end %>
      </div>
      <div>
        <p><%= link_to product.name, product %></p>
        <% if product.on_sale_price.present? %>
          <p style="text-decoration: line-through;">Price: <%= product.price %></p>
          <p>On Sale: <%= product.on_sale_price %></p>
        <% else %>
          <p>Price: <%= product.price %></p>
        <% end %>
      </div>
    </aside>
  <% end %>
</div>
<div>
  <%= paginate @products %>
</div>

<div>
  <%= link_to "Back to platforms", platforms_path %>
</div>
